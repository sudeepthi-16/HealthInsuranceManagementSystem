<h2>Manage Users</h2>

<div style="display: flex; gap: 12px; margin-bottom: 16px;">
  <button mat-raised-button color="primary" (click)="openCreateUser('InsuranceAgent')">
    âž• Add Insurance Agent
  </button>

  <button mat-raised-button color="primary" (click)="openCreateUser('ClaimsOfficer')">
    âž• Add Claims Officer
  </button>

  <button mat-raised-button color="accent" (click)="openCreateUser('Hospital')">
    âž• Add Hospital Manager
  </button>
  <button mat-raised-button color="accent" (click)="openCreateUser('Admin')">
    âž• Add Admin
  </button>
</div>


<!-- ðŸ” SEARCH -->
<mat-form-field appearance="outline" style="width: 300px; margin-left: 16px;">
  <mat-label>Search users</mat-label>
  <input matInput (keyup)="applyFilter($event)" placeholder="Name, email">
</mat-form-field>

<!-- ðŸ”½ ROLE FILTER -->
<mat-form-field appearance="outline" style="width: 200px; margin-left: 16px;">
  <mat-label>Filter by Role</mat-label>
  <mat-select (selectionChange)="applyRoleFilter($event.value)" [value]="selectedRole">
    <mat-option *ngFor="let r of roles" [value]="r">
      {{ r }}
    </mat-option>
  </mat-select>
</mat-form-field>

<p *ngIf="loading()">Loading users...</p>

<table mat-table [dataSource]="dataSource" class="mat-elevation-z2" *ngIf="!loading()">

  <ng-container matColumnDef="name">
    <th mat-header-cell *matHeaderCellDef>Name</th>
    <td mat-cell *matCellDef="let u">{{ u.fullName }}</td>
  </ng-container>

  <ng-container matColumnDef="email">
    <th mat-header-cell *matHeaderCellDef>Email</th>
    <td mat-cell *matCellDef="let u">{{ u.email }}</td>
  </ng-container>

  <ng-container matColumnDef="role">
    <th mat-header-cell *matHeaderCellDef>Role</th>
    <td mat-cell *matCellDef="let u">{{ getDisplayRole(u.role) }}</td>
  </ng-container>

  <ng-container matColumnDef="status">
    <th mat-header-cell *matHeaderCellDef>Active</th>
    <td mat-cell *matCellDef="let u">
      <mat-slide-toggle [checked]="u.isActive" (change)="toggleStatus(u, $event)">
      </mat-slide-toggle>
    </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="cols"></tr>
  <tr mat-row *matRowDef="let row; columns: cols"></tr>
</table>

<!-- ðŸ“„ PAGINATION -->
<mat-paginator [pageSize]="5" [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons>
</mat-paginator>